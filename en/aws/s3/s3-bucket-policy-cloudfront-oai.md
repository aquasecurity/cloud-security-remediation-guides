[![CloudSploit](https://cloudsploit.com/img/logo-new-big-text-100.png "CloudSploit")](https://cloudsploit.com)

# AWS / S3 / S3 Bucket Policy CloudFront OAI

## Quick Info

| | |
|-|-|
| **Plugin Title** | S3 Bucket Policy CloudFront OAI |
| **Cloud** | AWS |
| **Category** | S3 |
| **Description** | Ensures S3 bucket is origin to only one distribution and allows only that distribution |
| **More Info** | Access to CloudFront origins should only happen via ClouFront URL and not from S3 URL or any source in order to restrict access to private data |
| **AWS Link** | https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/private-content-restricting-access-to-s3.html |
| **Recommended Action** | Review the access policy for S3 bucket which is an origin to a CloudFront distribution. Make sure the S3 bucket is origin to only one distribution. Modify the S3 bucket access policy to allow CloudFront OAI for only the associated CloudFront distribution and restrict access from any other source. |

## Detailed Remediation Steps
1. Sign in to the AWS Management Console and open the CloudFront console at https://console.aws.amazon.com/cloudfront/v3/home. </br>
2. Choose the ID of a distribution that has an S3 origin. </br>
3. Choose the Origins tab. </br>
4. Select the Amazon S3 origin, and then choose Edit. </br>
5. For S3 bucket access, choose Yes use OAI. </br>
6. If you already have an OAI that you want to use, select the OAI from the drop-down list. If you already have an OAI, we recommend that you reuse it to simplify maintenance. </br>
7. If you want to create an OAI, choose Create new OAI. You can replace the autogenerated OAI name with a custom name if desired. </br>
8. If you want CloudFront to automatically update the Amazon S3 bucket policy to allow read access to the OAI, choose Yes, update the bucket policy. </br>
9. If you want to manually update permissions on your Amazon S3 bucket, choose No, I will update the bucket policy. For more information, see https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/private-content-restricting-access-to-s3.html#private-content-granting-permissions-to-oai </br>
10. If you update the bucket policy manually, make sure that you: Specify the correct OAI as the Principal in the policy. and give the OAI the permissions it needs to access objects on behalf of viewers. </br>
11. At the bottom of the page, choose Save changes. </br>
12. If you have more than one Amazon S3 origin, repeat the steps to add an OAI for each one. </br>